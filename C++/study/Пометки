никаких глобальных переменных; убрать ту энд; двойные указатели-> приравнивать к ф-и, чтобы она возвр рез-т
прописать явно окф
( в самом син чтобы он делал выброс исключения)
общий член в цикле сделать константой

