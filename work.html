<script>


  fetch('pullTextFromHere.html')
  .then(response => response.text())
  .then(fullText => {
    let reg = /(?<=\<script\>)(\n|.)*(?=\<\/script\>)/g
    return fullText.match(reg)
    //return (fullText)
  }
  )
  .then(insideScript => {


     //console.log(insideScript[0])


    const listIn = (from, r) => {

      let expl = new RegExp(r, 'g')
      let a = from.matchAll(expl)
      if (a) {
        a = Array.from(a)[0].groups
        a = Object.entries(a)
        a = a.filter((e)=>{return /^result/.test(e[0])})
        a = a.map((e)=>{return e[1]})
        console.log(a)
      }
      return a
    }
    const maxBefore = (bef, grName) => {
      return '(?=(?<'+grName+'>'+bef+'*))\\k<'+grName+'>'
    }
   
    let beg = (grNum) => { return '(?:async|function|const|let|var)' + maxBefore('\\s','fn1'+grNum) + maxBefore('\\w','fn2'+grNum) + maxBefore('\\s','fn3'+grNum) + '\\=?'+maxBefore('\\s','fn4'+grNum)+'\\('+maxBefore('[^()]','fn5'+grNum)+'\\)'+maxBefore('\\s','fn6'+grNum)+'(?:=>)?'+maxBefore('\\s','fn7'+grNum) +'\\{'  }                  
    let end = '\\}'
    let any = '(?:.||\\s)'
    //двойной ? это 0 или 1 - это делает символ необязательным
    let bb = (grNum) => { return '(?:'+any+'(?!'+beg(grNum+'1')+'))' }
    let be = '(?:'+any+'(?!'+end+'))'
    let arr = []
    
    let insertIn = (arr, num) => {
    for (let i=0; i<num; i++) {
    arr.splice(0,0, '(?<result'+arr.length+'>', beg('beg'+arr.length),'(?:',maxBefore(bb('bb'+arr.length),'mbb'+arr.length), any,')??')
    arr.splice(arr.length,0,'(?:',maxBefore(be,'be'+arr.length) , any,')??', end, ')')
    }
    }
    
    
   insertIn(arr,4)
    
    
    
    

   listIn(insideScript[0], arr.join(''))
   
   
   
 
    

  })


</script>